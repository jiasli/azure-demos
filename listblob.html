<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

    <script>
        $(document).ready(function ($) {
            $(".table-row").click(function () {
                console.log("clicked");
                window.document.location = $(this).data("href");

            });
        });

    </script>
</head>

<style>
    .table-row {
        cursor: pointer;
    }
</style>

<body onload="loadDoc()">

    <div style="max-width:1200px; margin:0 auto;" class="p-5">

        <h1>List Blob</h1>
        <p> Used technologies: Azure Storage SAS token, REST API, JavaScript, CORS </p>
        <br>
        <table id="demo" class="table table-hover"></table>
    </div>

    <script>
        function loadDoc() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myFunction(this);
                }
            };
            var url = "https://jlst.blob.core.windows.net/pic?restype=container&comp=list&st=2019-02-26T05%3A55%3A11Z&se=2020-02-27T05%3A55%3A00Z&sp=rl&sv=2018-03-28&sr=c&sig=1BU23jq%2BEYM8JyKwSPUxU4WuQ1aHDLA68fLzcklzFFw%3D"
            xhttp.open("GET", url, true);
            xhttp.send();
        }
        function myFunction(xml) {
            var i;
            var xmlDoc = xml.responseXML;
            var table = "<tr><th>Blob</th><th>Last-Modified</th><th>Content-Type</th><th>AccessTier</th></tr>";

            var endpoint = xmlDoc.getElementsByTagName("EnumerationResults")[0].getAttribute("ServiceEndpoint");
            var container = xmlDoc.getElementsByTagName("EnumerationResults")[0].getAttribute("ContainerName");

            console.log(endpoint);
            console.log(container);

            var x = xmlDoc.getElementsByTagName("Blob");

            for (i = 0; i < x.length; i++) {
                table += "<tr class=\"table-row\" data-href=\"" + endpoint + container + "/" + x[i].getElementsByTagName("Name")[0].childNodes[0].nodeValue + "\"><td>" +
                    x[i].getElementsByTagName("Name")[0].childNodes[0].nodeValue +
                    "</td><td>" +
                    x[i].getElementsByTagName("Last-Modified")[0].childNodes[0].nodeValue +
                    "</td><td>" +
                    x[i].getElementsByTagName("Content-Type")[0].childNodes[0].nodeValue +
                    "</td><td>" +
                    x[i].getElementsByTagName("AccessTier")[0].childNodes[0].nodeValue +
                    "</td></tr>";
            }
            document.getElementById("demo").innerHTML = table;

            // https://codepen.io/NaokiIshimura/pen/aEvQPY
            $(".table-row").click(function () {
                console.log("clicked");
                window.document.location = $(this).data("href");
            });
        }
    </script>

</body>
</html>
